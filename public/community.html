<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>K-D-A Launcher — Community</title>
  <link rel="icon" href="/assets/favicon.svg">
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/community.css">
</head>
<body>

<!-- loading screen -->
<div id="loadingScreen" class="loading-screen" hidden>
  <div class="loading-content">
    <div class="loading-spinner"></div>
    <p>Loading community…</p>
  </div>
</div>

<header class="topbar">
  <div class="topbar__left">
    <div class="brand">
      <svg width="28" height="28" viewBox="0 0 24 24" aria-hidden="true">
        <circle cx="12" cy="12" r="10" fill="currentColor" opacity="0.9"></circle>
        <circle cx="12" cy="12" r="4" fill="black" opacity="0.7"></circle>
      </svg>
      <span class="brand__text">K-D-A Launcher</span>
    </div>

    <nav class="nav">
      <button class="nav__link" data-route="store" onclick="window.location='/'">Underground</button>
      <button class="nav__link" data-route="library" onclick="window.location='/library'">Library</button>
      <button class="nav__link active" data-route="community" onclick="window.location='/community'">Community</button>
      <button class="nav__link trusted" data-route="trusted" onclick="window.location='/trusted'">Trusted ❤️</button>
    </nav>
  </div>

  <div class="topbar__right">
    <div class="search">
      <input id="threadSearch" type="search" placeholder="Search threads…">
    </div>
    <div class="avatar" id="accountBtn" title="Your account">A</div>
  </div>
</header>

<div class="layout">
  <aside class="sidebar">
    <div class="sidebar__section">
      <div class="sidebar__title">Categories</div>
      <ul class="sidebar__list">
        <li><button class="sidebar__item active" data-category="all">All</button></li>
        <li><button class="sidebar__item" data-category="games">Games</button></li>
        <li><button class="sidebar__item" data-category="tech">Tech</button></li>
        <li><button class="sidebar__item" data-category="mods">Mods</button></li>
        <li><button class="sidebar__item" data-category="offtopic">Off-topic</button></li>
      </ul>
    </div>

    <div class="sidebar__section">
      <div class="sidebar__title">Top Threads</div>
      <div id="topThreads" class="sidebar__games"></div>
    </div>

    <div class="sidebar__section">
      <div class="sidebar__title">Reputation (Games)</div>
      <div id="repBoard" class="rep-board"></div>
    </div>
  </aside>

  <main class="content">
    <section class="hero">
      <div class="hero__bg"></div>
      <div class="hero__content">
        <h1>Community Board</h1>
        <p>Discuss games, mods, fixes. Vote on threads and +rep/−rep games.</p>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;">
          <button id="newThreadBtn" class="btn btn--primary">Create Thread</button>
          <select id="sortSelect" class="select">
            <option value="new">Newest</option>
            <option value="top">Top (votes)</option>
            <option value="hot">Hot (balanced)</option>
          </select>
        </div>
      </div>
    </section>

    <section class="community">
      <div class="thread-list" id="threadList"></div>
      <div id="emptyState" class="empty-state" hidden>No threads yet. Be the first to post.</div>
    </section>
  </main>
</div>

<!-- Create Thread Modal -->
<div id="threadModal" class="modal" hidden>
  <div class="modal__dialog" style="max-width:720px;">
    <button id="closeModal" class="modal__close" aria-label="Close">×</button>
    <div class="modal__body" style="padding:16px;">
      <h2 style="margin:0 0 10px;">Create New Thread</h2>
      <form id="threadForm" class="form-col">
        <input type="text" id="threadTitle" placeholder="Thread title" required>
        <select id="threadCategory" required>
          <option value="games">Games</option>
          <option value="tech">Tech</option>
          <option value="mods">Mods</option>
          <option value="offtopic">Off-topic</option>
        </select>

        <!-- Optional game binding for reputation -->
        <div class="two-col">
          <input type="text" id="gameTitle" placeholder="Game title (optional)">
          <input type="text" id="gameSource" placeholder="Source (e.g., OnlineFix, Repack) (optional)">
        </div>

        <textarea id="threadBody" rows="6" placeholder="Write your post..." required></textarea>
        <div style="display:flex;gap:8px;justify-content:flex-end;">
          <button type="button" class="btn btn--ghost" id="cancelThread">Cancel</button>
          <button type="submit" class="btn btn--primary">Publish</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Comments Drawer -->
<div id="commentsDrawer" class="drawer" hidden>
  <div class="drawer__panel">
    <div class="drawer__header">
      <h3 id="commentsTitle">Comments</h3>
      <button id="commentsClose" class="modal__close" aria-label="Close">×</button>
    </div>
    <div id="commentsList" class="comments"></div>
    <form id="commentForm" class="comment-form">
      <input id="commentInput" type="text" placeholder="Write a comment…">
      <button class="btn btn--primary" type="submit">Send</button>
    </form>
  </div>
</div>

<script src="/js/community.js"></script>
</body>
</html>
