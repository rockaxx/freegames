<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>GAME.IT — Thread</title>

  <link rel="icon" href="/assets/favicon.svg">
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/community.css">
  <link rel="stylesheet" href="/css/community_detail.css">

  <script>
    let warnTimer = null;
    window.showWarning = (msg) => {
      const box = document.getElementById('warnBox');
      box.textContent = msg;
      box.style.display = 'block';
      if (warnTimer) clearTimeout(warnTimer);
      warnTimer = setTimeout(() => { box.style.display = 'none'; warnTimer = null; }, 3000);
    };
  </script>
</head>

<body>
<header class="topbar">
  <div class="topbar__left">
    <div class="brand" onclick="window.location='/'" role="button" aria-label="Go home">
      <svg width="28" height="28" viewBox="0 0 24 24" aria-hidden="true">
        <circle cx="12" cy="12" r="10" fill="currentColor" opacity="0.9"></circle>
        <circle cx="12" cy="12" r="4" fill="black" opacity="0.7"></circle>
      </svg>
      <span class="brand__text">GAME.IT</span>
    </div>

    <!-- Mobile burger -->
    <button id="mobileMenuBtn" class="burger" aria-label="Open menu">
      <span></span><span></span><span></span>
    </button>

    <nav class="nav">
      <button class="nav__link" onclick="window.location='/'">Underground</button>
      <button class="nav__link" onclick="window.location='/library'">Library</button>
      <button class="nav__link" onclick="window.location='/community'">Community</button>
      <button class="nav__link trusted" onclick="window.location='/trusted'">Trusted ❤️</button>
    </nav>
  </div>

  <!-- auth mount -->
  <div id="auth-root"></div>
</header>

<!-- Backdrop for mobile drawer -->
<div id="sidebarBackdrop" class="sidebar-backdrop" hidden></div>

<div class="layout">
  <!-- Use the same aside as mobile drawer; contains ONLY Back to list -->
  <aside class="sidebar" id="mobileDrawer">
    <div class="sidebar__section">
      <div class="sidebar__title">Navigation</div>
      <!-- Prefer history.back(); fallback to /community if no history -->
      <a class="mnav__item sidebar__item"
         href="/community"
         onclick="if (history.length>1){history.back();return false;}">
        ← Back to list
      </a>
    </div>
  </aside>

  <main class="content">
    <article id="thread" class="thread-detail thread-shell">
      <div class="thread-detail__votes">
        <button id="voteUp" class="vote-btn" aria-label="+1">▲</button>
        <span id="voteScore" class="vote-score">0</span>
        <button id="voteDown" class="vote-btn" aria-label="-1">▼</button>
      </div>

      <div class="thread-detail__main">
        <header class="thread-header">
          <h1 id="threadTitle"></h1>

          <div class="chips" id="threadMeta"></div>

          <div class="thread-toolbar">
            <button id="copyLink" class="btn btn--ghost sm" type="button">Copy link</button>
          </div>
        </header>

        <div id="repWrap" class="rep-line" hidden>
          <div class="rep-pill" id="repPill">
            <span id="repGameTitle"></span>
            <strong id="repScore"></strong>
          </div>
          <div class="rep-actions">
            <button id="repUp" class="rep-btn rep-btn--up" type="button">+rep</button>
            <button id="repDown" class="rep-btn rep-btn--down" type="button">-rep</button>
          </div>
        </div>

        <div class="thread-body prose" id="threadBody"></div>

        <section id="comments" class="comments-area">
          <div class="comments-area__head">
            <h2>Comments</h2>
            <div class="comments-count" id="commentsCount"></div>
          </div>

          <div id="commentsList" class="comments"></div>

          <form id="commentForm" class="comment-form" autocomplete="off">
            <input id="commentInput" type="text" placeholder="Write a comment…" aria-label="Comment">
            <button class="btn btn--primary" type="submit">Send</button>
          </form>
        </section>
      </div>
    </article>
  </main>
</div>

<div id="warnBox" style="
  position:fixed; top:20px; left:50%; transform:translateX(-50%);
  background:#a00; color:#fff; padding:10px 16px; border-radius:8px;
  font-weight:600; display:none; z-index:999999;
  box-shadow:0 4px 14px rgba(0,0,0,.4);
"></div>

<script src="/js/auth.js"></script>
<script src="/js/community_detail.js"></script>
<!-- Drawer/active logic -->
<script src="/js/mobile_menu.js"></script>
</body>
</html>
